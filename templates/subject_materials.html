{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">{{ subject.name }} - –ù–∞–≤—á–∞–ª—å–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏</h2>

    <!-- –°–µ–∫—Ü—ñ—è –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤ -->
    <div class="card shadow mb-5">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="card-title">üìö –ù–∞–≤—á–∞–ª—å–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏</h3>
                <a href="{{ url_for('routes.add_material', subject_id=subject.id) }}" 
                   class="btn btn-primary">
                   ‚ûï –î–æ–¥–∞—Ç–∏ –º–∞—Ç–µ—Ä—ñ–∞–ª
                </a>
            </div>

            {% if materials %}
                <div class="list-group">
                    {% for material in materials %}
                    <div class="list-group-item list-group-item-action">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h5 class="mb-1">{{ material.title }}</h5>
                                <p class="mb-1">{{ material.description }}</p>
                                <small class="text-muted">
                                    –î–æ–¥–∞–Ω–æ: {{ material.created_at.strftime('%d.%m.%Y %H:%M') }}
                                </small>
                            </div>
                            <div class="btn-group">
                                {% if material.file_path %}
                                <a href="{{ url_for('static', filename=material.file_path) }}" 
                                   class="btn btn-sm btn-success"
                                   download>
                                   ‚¨áÔ∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏
                                </a>
                                {% endif %}
                                <form method="POST" 
                                      action="{{ url_for('routes.delete_material', material_id=material.id) }}">
                                    <button type="submit" class="btn btn-sm btn-danger ms-2">
                                        ‚ùå –í–∏–¥–∞–ª–∏—Ç–∏
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="alert alert-info mt-3">
                    –ù–∞—Ä–∞–∑—ñ –Ω–µ–º–∞—î –¥–æ–¥–∞–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤
                </div>
            {% endif %}
        </div>
    </div>

    <!-- –°–µ–∫—Ü—ñ—è –æ—Ü—ñ–Ω–æ–∫ -->
    <div class="card shadow">
        <div class="card-body">
            <h3 class="card-title mb-4">üìä –í–∏—Å—Ç–∞–≤–ª–µ–Ω—ñ –æ—Ü—ñ–Ω–∫–∏</h3>
            
            {% if grades %}
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>–°—Ç—É–¥–µ–Ω—Ç</th>
                                <th>–û—Ü—ñ–Ω–∫–∞</th>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ö–æ–º–µ–Ω—Ç–∞—Ä</th>
                                <th>–î—ñ—ó</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for grade, student_name in grades %}
                            <tr>
                                <td>{{ student_name }}</td>
                                <td>
                                    <span class="badge bg-primary rounded-pill">
                                        {{ grade.grade }}
                                    </span>
                                </td>
                                <td>{{ grade.date.strftime('%d.%m.%Y') }}</td>
                                <td class="fst-italic text-muted">
                                    {{ grade.comment or "‚Äî" }}
                                </td>
                                <td>
                                    <a href="{{ url_for('routes.subject_grades', subject_id=grade.subject_id) }}" 
                                       class="btn btn-sm btn-outline-warning">
                                       ‚úèÔ∏è –î–µ—Ç–∞–ª—ñ
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="alert alert-info mt-3">
                    –©–µ –Ω–µ –≤–∏—Å—Ç–∞–≤–ª–µ–Ω–æ –∂–æ–¥–Ω–æ—ó –æ—Ü—ñ–Ω–∫–∏
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}